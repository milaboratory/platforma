pt := import("@platforma-sdk/workflow-tengo:pt")
pframes := import("@platforma-sdk/workflow-tengo:pframes")

self := import("@platforma-sdk/workflow-tengo:workflow")

self.body(func(inputs) {
	csv := inputs.inputCsv
	saveFrameParams := inputs.saveFrameParams

	wf := pt.workflow()

	df := wf.frame(csv, { xsvType: "csv" })
	df.saveFrameDirect("output", saveFrameParams)

	ptResult := wf.run()
	pf := ptResult.getFrameDirect("output")

	return {
		outputs: {
			pf: pframes.exportFrame(pf)
		},
		exports: {
			pf: pf
		}
	}
})
